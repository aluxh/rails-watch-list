<% banner_style = @list.photo.attached? ? "background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url(#{cl_image_path(@list.photo.key, height: 300, crop: :fill)})" : "" %>
<div class="banner position-relative" style="<%= banner_style %>">
  <div class="border border-0 bg-warning px-3 py-2 position-absolute top-right text-white rounded"><%= @list.movies.size %> movies</div>
  <div class="container">
    <h1><%= @list.name %></h1>
  </div>
</div>

<div class="container mt-5">
  <div class="d-flex justify-content-end align-items-center">
    <%= link_to "Add a movie", new_list_bookmark_path(@list), class: "btn btn-success rounded text-white" %>
  </div>

  <div class="row my-5">
    <% @list.bookmarks.each do |bookmark| %>
    <div class="col-6 mb-5">
      <div class="card h-100 shadow">
        <%= image_tag bookmark.movie.poster_url,
            alt: bookmark.movie.title,
            class: "card-img-top",
            style: "height: 350px; object-fit: cover;" %>
        <div class="d-flex flex-column justify-content-between flex-grow-1">
          <div class="card-body">
            <h5 class="card-title">
              <strong><%= bookmark.movie.title %></strong> · <%= bookmark.movie.rating.round(1) %> ⭐️
            </h5>
            <p class="card-subtitle text-body-secondary fs-7"><%= bookmark.movie.overview %></p>
          </div>
          <div class="card-body d-flex flex-column justify-content-end">
            <div class="d-flex justify-content-between align-items-start">
              <div class="d-flex gap-2 justify-content-start align-items-center gap-3">
                <i class="fa-solid fa-quote-left fa-xl"></i>
                <p class="mb-0"><%= bookmark.comment %></p>
              </div>
                <%= link_to "Delete", bookmark_path(bookmark),
                  data: {turbo_method: :delete, turbo_confirm: "Are you sure?"},
                  class: "text-danger text-decoration-none"  %>

            </div>
          </div>
        </div>
      </div>
    </div>
    <% end %>
  </div>
</div>

<hr>
<div class="container mt-5">
  <div class="row my-5">
    <div class="col-6">
      <h3>Reviews</h3>
      <% @list.reviews.each do |review| %>
        <div class="mb-3">
          <div class="fs-4"><%= "⭐️" * review.rating %></div>
        </div>
        <p><%= review.content %></p>
        <hr>
      <% end %>
    </div>
    <div class="col-6">
      <h4>Add your review</h4>
      <%= simple_form_for([@list, @review]) do |f| %>
        <%= f.input :content %>
        <%= f.input :rating %>
        <%= f.submit %>
      <% end %>
    </div>
  </div>
</div>
